import { EvaluationAssignment } from '../../domain/entities/evaluation-assignment.entity';
import { EvaluationAssignmentOrmEntity } from './evaluation-assignment.orm-entity';

export class EvaluationAssignmentMapper {
  static toDomain(orm: EvaluationAssignmentOrmEntity): EvaluationAssignment {
    return EvaluationAssignment.reconstitute(
      orm.uuid, // Use UUID for external identification
      String(orm.collaboratorId),
      orm.evaluatorUserId ? String(orm.evaluatorUserId) : null,
      String(orm.templateId),
      orm.milestone,
      orm.status,
      orm.dueDate,
      orm.completedAt,
      orm.answers || [],
      orm.score,
      orm.createdAt,
      orm.updatedAt,
    );
  }

  static toOrm(domain: EvaluationAssignment): EvaluationAssignmentOrmEntity {
    const orm = new EvaluationAssignmentOrmEntity();
    // Note: uuid is auto-generated by DB, don't set it when creating new records
    orm.uuid = domain.id;
    orm.collaboratorId = Number(domain.collaboratorId);
    orm.evaluatorUserId = domain.evaluatorUserId
      ? Number(domain.evaluatorUserId)
      : null;
    orm.templateId = Number(domain.templateId);
    orm.milestone = domain.milestone;
    orm.status = domain.status;
    orm.dueDate = domain.dueDate;
    orm.completedAt = domain.completedAt;
    orm.answers = domain.answers;
    orm.score = domain.score;
    orm.createdAt = domain.createdAt;
    orm.updatedAt = domain.updatedAt;
    return orm;
  }
}

